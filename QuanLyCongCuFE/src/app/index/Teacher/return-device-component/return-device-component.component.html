<div class="container">
    <div class="header">
        <h1><i class="fas fa-box-open"></i> TR·∫¢ THI·∫æT B·ªä</h1>
    </div>
    <div class="main-content">
        <div class="card">
            <h2>T√¨m ki·∫øm Phi·∫øu M∆∞·ª£n</h2>

            <div class="admin-notice" id="adminNotice" style="display: none;">
                üîß <strong>Qu·∫£n tr·ªã vi√™n:</strong> B·∫°n c√≥ th·ªÉ tr·∫£ thi·∫øt b·ªã cho m·ªçi ng∆∞·ªùi
            </div>

            <div class="form-group">
                <label for="borrowId" class="required">M√£ phi·∫øu m∆∞·ª£n (Borrow ID)</label>
                <input type="number" id="borrowId" placeholder="Nh·∫≠p m√£ phi·∫øu m∆∞·ª£n...">
            </div>

            <div class="teacher-warning" id="teacherWarning" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i> <strong>Gi√°o vi√™n:</strong> B·∫°n ch·ªâ c√≥ th·ªÉ tr·∫£ thi·∫øt b·ªã do
                ch√≠nh m√¨nh m∆∞·ª£n
            </div>

            <div id="teacherSection" *ngIf="role == 'TEACHER'">
                <button type="button" class="search-btn" (click)="searchMyBorrows()">
                    <i class="fas fa-list"></i> Xem thi·∫øt b·ªã t√¥i ƒëang m∆∞·ª£n
                </button>
            </div>

            <button type="button" class="search-btn" onclick="searchBorrow()">
                üîç T√¨m ki·∫øm Phi·∫øu M∆∞·ª£n
            </button>

            <div id="myBorrowsList" *ngIf="searched">
                <div *ngIf="listBorrow.length > 0; else nolistBorrow">
                    <h3>Thi·∫øt b·ªã b·∫°n ƒëang m∆∞·ª£n:</h3>
                    <div id="borrowsListContent">
                        <div *ngFor="let borrow of listBorrow" class="borrow-item" (click)="selectBorrow(borrow)"
                            [class.active]="selectedBorrow?.borrowId === borrow.borrowId">
                            <div class="borrow-card">
                                <p><strong>M√£ phi·∫øu m∆∞·ª£n:</strong> {{borrow.borrowId}}</p>
                                <p><strong>T√™n thi·∫øt b·ªã:</strong> {{borrow.device.deviceName}}</p>
                                <p><strong>Ng√†y m∆∞·ª£n:</strong> {{borrow.actualStartTime | date:'dd/MM/yyyy HH:mm'}}</p>
                                <p><strong>H·∫°n tr·∫£:</strong> {{borrow.actualEndTime | date:'dd/MM/yyyy HH:mm'}}</p>
                                <p *ngIf="borrow.notes"><strong>Ghi ch√∫:</strong> {{borrow.notes}}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <ng-template #nolistBorrow>
                <div class="no-borrows-message">
                    <i class="fa-solid fa-circle-exclamation"></i>
                    <p>B·∫°n kh√¥ng c√≥ thi·∫øt b·ªã n√†o ƒëang m∆∞·ª£n.</p>
                </div>
            </ng-template>
        </div>

        <div class="card">
            <h2>Th√¥ng tin Tr·∫£ thi·∫øt b·ªã</h2>

            <form id="returnForm" #form="ngForm" (ngSubmit)="returnDevice()">
                <div class="form-group">
                    <label for="returnDate" class="required">Ng√†y tr·∫£ th·ª±c t·∫ø</label>
                    <input type="datetime-local" id="returnDate" required [(ngModel)]="returnForm.returnDate" name="returnDate">
                </div>

                <div class="form-group">
                    <label class="required">T√¨nh tr·∫°ng thi·∫øt b·ªã khi tr·∫£</label>
                    <div class="status-options">
                        <label class="status-option">
                            <input type="radio" name="condition" value="GOOD" required
                                [(ngModel)]="returnForm.condition">
                            <span><i class="fas fa-check-circle" style="color: #2ecc71;"></i> T·ªët</span>
                        </label>
                        <label class="status-option">
                            <input type="radio" name="condition" value="MINOR_DAMAGE"
                                [(ngModel)]="returnForm.condition">
                            <span><i class="fas fa-exclamation-triangle" style="color: #f39c12;"></i> H∆∞ h·ªèng nh·∫π</span>
                        </label>
                        <label class="status-option">
                            <input type="radio" name="condition" value="MAJOR_DAMAGE"
                                [(ngModel)]="returnForm.condition">
                            <span><i class="fas fa-times-circle" style="color: #e74c3c;"></i> H∆∞ h·ªèng n·∫∑ng</span>
                        </label>
                        <label class="status-option">
                            <input type="radio" name="condition" value="MISSING_ACCESSORIES"
                                [(ngModel)]="returnForm.condition">
                            <span><i class="fas fa-box-open" style="color: #3498db;"></i> M·∫•t ph·ª• ki·ªán</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="notes">Ghi ch√∫ t√¨nh tr·∫°ng</label>
                    <textarea id="notes" placeholder="M√¥ t·∫£ chi ti·∫øt t√¨nh tr·∫°ng thi·∫øt b·ªã, h∆∞ h·ªèng c·ª• th·ªÉ..."
                        [(ngModel)]="returnForm.notes" name="notes"></textarea>
                </div>

                <div class="form-group">
                    <label for="receivedBy" class="required">Ng∆∞·ªùi ti·∫øp nh·∫≠n</label>
                    <input type="text" id="receivedBy" placeholder="H·ªç t√™n ng∆∞·ªùi ti·∫øp nh·∫≠n thi·∫øt b·ªã..." required
                        [(ngModel)]="returnForm.receivedBy" name="receivedBy">
                </div>
                <div class="btn-group">
                    <button type="button" class="btn btn-cancel" (click)="resetForm()">H·ªßy b·ªè</button>
                    <button type="submit" class="btn btn-submit" [disabled]="!selectedBorrow">X√°c nh·∫≠n Tr·∫£ thi·∫øt
                        b·ªã</button>
                </div>
            </form>
        </div>
    </div>
</div>